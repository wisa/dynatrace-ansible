---
  - name: Provisioning VM on RHV
    hosts: rhvm.wisa.mylab
    gather_facts: false
    become: true
    vars_files: secret.yaml
    tasks:
      - name: Login
        ovirt_auth:
          url: "{{ OVIRT_URL }}"
          username: "{{ OVIRT_USER }}"
          password: "{{ OVIRT_PASS }}"

      - name: Deploy VM and running it
        ovirt_vm:
          auth: "{{ ovirt_auth }}"
          state: running
          cluster: Default
          name: "{{ VM_NAME }}"
          memory: "{{ MEM_SIZE }}GiB"
          cpu_cores: "{{ CPU_SIZE }}"
          type: server
          operating_system: other_linux
          nics:
          - name: nic1
            profile_name: ovirtmgmt
          template: Centos7-Template

      - name: Pause for 120 second before update the inventory
        pause:
          minutes: 2

